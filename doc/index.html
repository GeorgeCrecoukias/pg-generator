<!DOCTYPE html>

<html lang="en">
<head>
	<meta charset="utf-8">
	<title>sequelize-pg-generator Index</title>

	<!--[if lt IE 9]>
	<script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->
	<link type="text/css" rel="stylesheet" href="styles/sunlight.default.css">

	<link type="text/css" rel="stylesheet" href="styles/site.cerulean.css">

</head>

<body>
<div class="container-fluid">
	<div class="navbar navbar-fixed-top navbar-inverse">
		<div class="navbar-inner">
			<a class="brand" href="index.html">sequelize-pg-generator</a>
			<ul class="nav">
				
				<li class="dropdown">
					<a href="modules.list.html" class="dropdown-toggle" data-toggle="dropdown">Modules<b
						class="caret"></b></a>

					<ul class="dropdown-menu ">
						
						<li>
							<a href="module-lib_index.html">lib/index</a>
						</li>
						
						<li>
							<a href="module-path_to_model.html">path/to/model</a>
						</li>
						

					</ul>
				</li>
				
				<li class="dropdown">
					<a href="classes.list.html" class="dropdown-toggle" data-toggle="dropdown">Classes<b
						class="caret"></b></a>

					<ul class="dropdown-menu ">
						
						<li>
							<a href="GeneratorUtil.html">GeneratorUtil</a>
						</li>
						

					</ul>
				</li>
				
			</ul>
		</div>
	</div>

	<div class="row-fluid">

		
		<div class="span8">
			
				<div id="main">
					


	
	<span class="page-title">Index</span>
	
	












	
	





    <section class="readme-section">
        <article><h2>Description</h2><p>This module is for auto generating Sequelize model from PostgreSQL databases. It reverse engineers your database and generates separate model files for each table. Default configuration parameters are carefully selected and it is sane to use. However it is possible to change most behaviour via configuration. This document is based on default configuration. Configuration parameters and default values are written as (Config parameter:value) where appropriate.</p>
<h2>Special Thanks</h2><p>This module is developed with sponsorship of Fortibase.</p>
<h2>Usage</h2><h3>Step 1: Install globally via npm -g</h3><p>This will install module and CLI command</p>
<pre class="prettyprint source"><code>$ npm install -g sequelize-pg-generator</code></pre><h3>Step 2: Generate model files</h3><p>Open terminal, go to your app.js root and create your models automatically into 'model' directory.</p>
<pre class="prettyprint source"><code>$ cd path/to/my/node-app.js
$ spgen -database my_database -u my_user -p my_password</code></pre><h3>Step 3: Use it in your node.js app</h3><p>Use Sequelize models provided by auto generated files in your application.</p>
<pre class="prettyprint source"><code>var orm = require('../model');
orm.setup('template_sequelize', 'my_user', 'my_password', {
    host: '127.0.0.1',
    logging: false,
    native: true
});
var sequelize = orm.sequelize;
var contact = orm.model('public.contact'); // Can be configured without schema.</code></pre><h2>CLI Options</h2><pre class="prettyprint source"><code>spgen [options]
-h, --host [host]           IP address or host name of the database server
-pr, --port [port]          Port of database server to connect
-d, --database [database]   Database name
-u, --user [user]           Username to connect to database
-p, --password [password]   Password to connect to database
-s, --schema [schema]       Comma separated names of the database schemas
-o, --output [output]       Output folder
-c, --config [config]       Path of the configuration file</code></pre><ul>
<li>No Dependencies On Generated Files</li>
<li>Multi schema support,</li>
<li>One to many relation support, (hasMany and belongsTo)</li>
<li>Many to many relation support, (hasMany through and belongsToMany)</li>
<li>Inter-schema relation support. (i.e. public.account table to other_schema.cutomer table),</li>
<li>Highly configurable,</li>
<li>Fully customizable,</li>
<li>CLI support,</li>
<li>Smart naming of models and relations,</li>
<li>Very easy to override auto generated files</li>
<li>Exclude tables</li>
<li>Debug</li>
<li>Table Specific Configuration</li>
</ul>
<h2>WARNING: belongsToMany</h2><p>For many to many relations Sequelize version 2.0 RC3 and older does not support belongsToMany relation. After this version hasMany through relations are deprecated. Behaviour on this subject can be adjusted via configuration. (Config: generate.hasManyThrough:false and generate.belongsToMany:true)</p>
<h2>Features</h2><h3>No Dependencies On Generated Files</h3><p>Generated files have no dependencies besides core modules and Sequelize.</p>
<h3>Multi Schema Support</h3><p>Supports multi PostgreSQL schemas. It is possible to have other schemas than public. User can select which schemas to reverse engineer via CLI or config. If more than one schema is included, models may be prefixed with schema names. (Config: generate.useSchemaName: true, database.schema: [&quot;public&quot;]) to prevent tables with same name in different schemas try to have same model name.</p>
<pre class="prettyprint source"><code>contact = orm.model('public.contact'); // Returns sequelize model for contact table.</code></pre><h3>No Schema Prefix</h3><p>User can configure not to prefix model names with schema</p>
<pre class="prettyprint source"><code>// In config
{...
    generate{
        useSchemaName: false
    }
}

contact = orm.model('contact'); // Returns sequelize model for contact table.</code></pre><h3>One To Many Relation Support</h3><p>This module automatically detects one to many relations and generates model.hasMany and model.belongsTo sequelize relations.</p>
<h3>Many To Many Relation Support</h3><p>If two tables are joined via a join table this module detects it automatically and generates many to many sequelize relations. Detection method is as follows: If a table has more than one foreign key, then it is considered</p>
<pre class="prettyprint source"><code>                  hasMany              hasMany
TABLE:   product --------&lt; line_item >--------- cart
COLUMNS: id                cart_id              id
         name              product_id           customer_id
         color             quantity</code></pre><p>This module generates belongsToMany relation and hasMany relation with through option. As of this writing master branch of Sequelize deprecated hasMany through relations. According to version of Sequelize you use, it should be adjusted via config of this module.</p>
<h3>Inter-Schema Relation Support</h3><p>Detects relations between tables in different schemas. For example relations between public.account table and other_schema.customer table.</p>
<h3>Highly configurable</h3><p>This module uses node-configure module. It is also possible to point a custom configuration file via CLI. See configuration parameters below in this document.</p>
<h3>Fully Customizable</h3><p>This module uses <a href="https://www.npmjs.com/package/consolidate">consolidate</a> compatible templates to generate model files. It uses <a href="https://www.npmjs.com/package/swig">Swig</a> by default. User can use his/her custom templates without altering original one by pointing (COnfig: template.folder and template.engine:'swig') config values. Looking default templates in template folder of this module is highly recommended.</p>
<p>There should at least be three files in custom template folder:
    index.ext  Default template file. ext is whatever extension is used for your template engine.
    index.js   This file is copied with generated files. It's purpose is use generated files
    utils.js   This file is copied with generated files. Contains helper functions.</p>
<h3>CLI Supoport</h3><p>If this module is installed globally with npm -g then sqgen command would be available system wide to generate model files.</p>
<h3>Smart Naming of Models and Relations</h3><p>pg-sequelize-generator uses table names or schema.table names for model naming. For relations it uses foreign key names and relation names from your database. (You are naming your relations in database meaningfully right?) Both camel case (tableName) or untouched names (table_name) methods can be used via configuration. Naming conventions are based on Sequelize module suggestions and generated explicitly with 'as' parameter.</p>
<pre class="prettyprint source"><code>                  product_cart_line_items              cart_cart_line_items
TABLE:   product -------------------------&lt; line_item >--------------------- cart
COLUMNS: id                                 cart_id                          id
         name                               product                          customer_id
         color                              quantity

NOTE: Beware line_item.cart_id has id suffix but line_item.product hasn't. This inconsistency is made purposefully for the sake of this example.

Type of object          Naming Rule
--------------          -----------
Model                   tableName or schema.tableName
hasMany                 Plural of the relation name in database. Table name from beginning can be stripped.
                        (Config: generate.stripFirstTableFromHasMany:true)
belongsTo               Singular of foreign key. If kay name ends with _id it will be stripped. Otherwise
                        'related' is added at the beginning to prevent it gets clash with column name.
                        (Config: generate.prefixForBelongsTo)
belongsToMany           Plural of the foreign key which refers other table in join table.
hasMany({through:..})   Plural of the foreign key which refers other table in join table. (DEPRECATED in Sequelize)

For the example structure:

Relation                as                          Details
--------                --                          -------
product.hasMany         as:'cartLineItems'          (Plural) Table name 'product' is stripped from the beginning of
                                                    relation name 'product_cart_line_items'
product.belongsToMany   as:'carts'                  (Plural) _id suffix is stripped from foreign key name 'cart_id'
product.hasMany Through as:'carts'                  (Plural) _id suffix is stripped from foreign key name 'cart_id'
cart.hasMany            as:'cartLineItems'          (Plural) Table name 'cart' is stripped from the beginning of
                                                    relation name 'cart_cart_line_items'
cart.belongsToMany      as:'relatedProducts'        (Plural) No _id suffix. related is added as prefix.
cart.hasMany Through    as:'relatedProducts'        (Plural) No _id suffix. related is added as prefix.
lineItem.belongsTo      as:'relatedProduct'         (Singular) No _id suffix. related is added as prefix.
lineItem.belongsTo      as:'cart'                   (Singular) No _id suffix. related is added as prefix.</code></pre><p>Of course as all attributes, you can modify names of generated files in a non-destructive way as explained below.</p>
<h3>Very Easy to Override Auto Generated Files</h3><p>By default auto generated files are located path/to/model/definition-files directory. Also there is 'definition-files-custom' directory. Users can create files with same names as auto generated files to override its attributes. There is also utils module generated to make modifications easier.</p>
<p>Those modifications are non destructive, because they override generated file in another file by inheriting it and default index.js file uses inherited files if it exists. Please bear in mind, those modifications occur before sequelize instances are generated.</p>
<p>For example for product table 'definition-files/cart.js' is generated. User can create 'definition-files-custom/cart.js' and override necessary parts like example below. For all attributes you can look inside auto generated files.</p>
<pre class="prettyprint source"><code>&quot;use strict&quot;;
var orm     = require('../index.js'),
    model   = require('../definition-files/public_cart.js'),
    util    = require('../utils.js')(model),
    Seq     = orm.Sequelize();

module.exports = model;

util.getAttribute('id').validate = {... Some Sequelize Validations}; // Add Sequelize validation.
util.getRelation('relatedProducts').details.as = 'soldItems';        // Don't like default relation name? Change it.
util.renameAttribute('customerId', 'clientId');                      // Change name of the attribute.</code></pre><h3>Exclude Tables</h3><p>It is possible to exclude some table from auto generation. (Config generate.skipTable:[]) array is used to define excluded tables. sequelize-pg-generator skips those tables and relations from and to those tables.</p>
<h3>Debug</h3><p>Default index.js file creates a file called debug.js in the model directory. This file can be examined what type of code is used by index.js. It is same code that would be used if there is no index.js file exists. However if this type of static file would be used, it is harder to allow modifications in a non-destructive way.</p>
<h3>Table Specific Configuration</h3><p>Sometimes for some tables it is needed to have different rules then other tables have. In such situations configuration file allows table level overrides. All 'generate' and 'tableOptions' config parameters can be overridden with 'generateOverride' and 'tableOptionsOverride'.</p>
<pre class="prettyprint source"><code>&quot;generate&quot;: {
    &quot;columnDescription&quot;: true,
    &quot;tableDescription&quot;: true,
    ...
},
&quot;generateOverride&quot;: {
    &quot;contact&quot;: {
        &quot;tableDescription&quot;: false
    }
},
&quot;tableOptions&quot;: {
    &quot;timestamps&quot;: false,
    &quot;camelCase&quot;: true,
    &quot;paranoid&quot;: false,
    ...
},
&quot;tableOptionsOverride&quot;: {
    &quot;contact&quot;: {
        &quot;paranoid&quot;: true
    }
}
...</code></pre><h1>Configuration</h1><p>Configuration parameters and default values are described below. Configuration is enclosed in &quot;sequelize-pg-generator&quot; key, because you may want to combine sequelize-pg-generator configuration with your main application configuration. This way generator's configuration does not clash with yours. <a href="https://www.npmjs.com/package/node-config">node-config</a> allows this.</p>
<h4>database</h4><pre class="prettyprint source"><code>**host**: IP address or host name of the database server.
**port**: Port of database server to connect.
**database**: Database name.
**user**: Username to connect to database.
**password**: Password to connect to database.
**schema**: Array of names of the database schemas to be parsed.</code></pre><h4>template</h4><p><strong>engine</strong>: Template engine to use for generating model files. Any <a href="https://www.npmjs.com/package/consolidate">consolidate</a> compatible template engine can be used.
<strong>extension</strong>: Extension of template files.
<strong>folder</strong>: Path of the template directory which contains template files.</p>
<table>
    <tr>
        <td colspan="2"><h4>database</h4></td>
    </tr>
    <tr>
        <td width="250"><strong>host</strong></td>
        <td>IP address or host name of the database server.</td>
    </tr>
    <tr>
        <td><strong>port</strong></td>
        <td>Port of database server to connect.</td>
    </tr>
    <tr>
        <td><strong>database</strong></td>
        <td>Database name.</td>
    </tr>
    <tr>
        <td><strong>user</strong></td>
        <td>Username to connect to database.</td>
    </tr>
    <tr>
        <td><strong>password</strong></td>
        <td>Password to connect to database.</td>
    </tr>
    <tr>
        <td><strong>schema</strong></td>
        <td>Array of names of the database schemas to be parsed.</td>
    </tr>
    <tr>
        <td></td>
        <td></td>
    </tr>
    <tr>
        <td></td>
        <td></td>
    </tr>
    <tr>
        <td></td>
        <td></td>
    </tr>
    <tr>
        <td></td>
        <td></td>
    </tr>
</table>

<pre class="prettyprint source"><code>-h, --host [host]           IP address or host name of the database server
-pr, --port [port]          Port of database server to connect
-d, --database [database]   Database name
-u, --user [user]           Username to connect to database
-p, --password [password]   Password to connect to database
-s, --schema [schema]       Comma separated names of the database schemas
-o, --output [output]       Output folder
-c, --config [config]       Path of the configuration file



module.exports = {
    &quot;sequelize-pg-generator&quot;: {
        &quot;database&quot;: {
            &quot;host&quot;: &quot;127.0.0.1&quot;,            // Host or IP of the database
            &quot;port&quot;: 5432,                   // Port of the database
            &quot;user&quot;: &quot;user&quot;,
            &quot;password&quot;: &quot;password&quot;,
            &quot;database&quot;: &quot;&quot;,
            &quot;schema&quot;: [&quot;public&quot;]
        },
        &quot;template&quot;: {
            &quot;engine&quot;: &quot;swig&quot;,
            &quot;extension&quot;: &quot;html&quot;,
            &quot;folder&quot;: path.join(__dirname, '..', 'template')
        },
        &quot;output&quot;: {
            &quot;log&quot;: true,
            &quot;folder&quot;: &quot;./model&quot;,
            &quot;beautify&quot;: true,
            &quot;indent&quot;: 4,
            &quot;preserveNewLines&quot;: false,
            &quot;warning&quot;: true
        },
        &quot;generate&quot;: {
            &quot;stripFirstTableFromHasMany&quot;: true,
            &quot;hasManyThrough&quot;: false,
            &quot;belongsToMany&quot;: true,
            &quot;prefixForBelongsTo&quot;: &quot;related&quot;,
            &quot;useSchemaName&quot;: true,
            &quot;modelCamelCase&quot;: true,
            &quot;relationAccessorCamelCase&quot;: true,
            &quot;columnAccessorCamelCase&quot;: true,
            &quot;columnDefault&quot;: true,
            &quot;columnDescription&quot;: true,
            &quot;columnAutoIncrement&quot;: true,
            &quot;tableDescription&quot;: true,
            &quot;dataTypeVariable&quot;: &quot;Seq&quot;,
            &quot;skipTable&quot;: []
        },
        &quot;generateOverride&quot;: {
            &quot;contact&quot;: {
                &quot;tableDescription&quot;: false
            }
        },
        &quot;tableOptions&quot;: {
            &quot;timestamps&quot;: false,
            &quot;camelCase&quot;: true,
            &quot;paranoid&quot;: false
        },
        &quot;tableOptionsOverride&quot;: {
            &quot;contact&quot;: {
                &quot;paranoid&quot;: true
            }
        }
    }
};</code></pre><h1>API</h1></article>
    </section>







				</div>

				<div class="clearfix"></div>
				<footer>
					
					
		<span class="copyright">
		sequelize-pg-generator Copyright © 2014 Özüm Eldoğan.
		</span>
					<br />
					
		<span class="jsdoc-message">
		Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.3.0-alpha10</a>
		on Wed Dec 24th 2014 using the <a
			href="https://github.com/terryweiss/docstrap">DocStrap template</a>.
		</span>
				</footer>
			</div>

			
			<div class="span3">
				<div id="toc"></div>
			</div>
			
			<br clear="both">
		</div>

	</div>
	<!--<script src="scripts/sunlight.js"></script>-->
	<script src="scripts/docstrap.lib.js"></script>
	<script src="scripts/bootstrap-dropdown.js"></script>
	<script src="scripts/toc.js"></script>

	<script>
		$( function () {
			$( "[id*='$']" ).each( function () {
				var $this = $( this );

				$this.attr( "id", $this.attr( "id" ).replace( "$", "__" ) );
			} );

			$( "#toc" ).toc( {
				anchorName  : function ( i, heading, prefix ) {
					return $( heading ).attr( "id" ) || ( prefix + i );
				},
				selectors   : "h1,h2,h3,h4",
				showAndHide : false,
				scrollTo    : "100px"
			} );

			$( "#toc>ul" ).addClass( "nav nav-pills nav-stacked" );
			$( "#main span[id^='toc']" ).addClass( "toc-shim" );
			$( '.dropdown-toggle' ).dropdown();
//			$( ".tutorial-section pre, .readme-section pre" ).addClass( "sunlight-highlight-javascript" ).addClass( "linenums" );

			$( ".tutorial-section pre, .readme-section pre" ).each( function () {
				var $this = $( this );

				var example = $this.find( "code" );
				exampleText = example.html();
				var lang = /{@lang (.*?)}/.exec( exampleText );
				if ( lang && lang[1] ) {
					exampleText = exampleText.replace( lang[0], "" );
					example.html( exampleText );
					lang = lang[1];
				} else {
					lang = "javascript";
				}

				if ( lang ) {

					$this
						.addClass( "sunlight-highlight-" + lang )
						.addClass( "linenums" )
						.html( example.html() );

				}
			} );

			Sunlight.highlightAll( {
				lineNumbers : true,
				showMenu : true,
				enableDoclinks : true
			} );
		} );
	 </script>



	<!--Navigation and Symbol Display-->
	


	<!--Google Analytics-->
	

</body>
</html>